
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../st_logs/">
      
      
        <link rel="next" href="../app/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.12">
    
    
      
        <title>Tab-rendering fix (js) - Saving Willy Code Documentation</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.2afb09e1.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#src.fix_tabrender" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Saving Willy Code Documentation" class="md-header__button md-logo" aria-label="Saving Willy Code Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Saving Willy Code Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Tab-rendering fix (js)
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Saving Willy Code Documentation" class="md-nav__button md-logo" aria-label="Saving Willy Code Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Saving Willy Code Documentation
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    README
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    API
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            API
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../main/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Main app
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Modules
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            Modules
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../input_handling/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Data entry handling
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../obs_map/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Map of observations
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../whale_gallery/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Whale gallery
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../whale_viewer/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Whale viewer
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../st_logs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Logging
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Tab-rendering fix (js)
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Tab-rendering fix (js)
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#src.fix_tabrender" class="md-nav__link">
    <span class="md-ellipsis">
      fix_tabrender
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.fix_tabrender.inject_iframe_js_code" class="md-nav__link">
    <span class="md-ellipsis">
      inject_iframe_js_code
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.fix_tabrender.js_show_zeroheight_iframe" class="md-nav__link">
    <span class="md-ellipsis">
      js_show_zeroheight_iframe
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3" >
        
          
          <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Development clutter
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            Development clutter
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../app/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Demo app
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    How to contribute
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            How to contribute
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dev_notes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Dev Notes
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#src.fix_tabrender" class="md-nav__link">
    <span class="md-ellipsis">
      fix_tabrender
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.fix_tabrender.inject_iframe_js_code" class="md-nav__link">
    <span class="md-ellipsis">
      inject_iframe_js_code
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#src.fix_tabrender.js_show_zeroheight_iframe" class="md-nav__link">
    <span class="md-ellipsis">
      js_show_zeroheight_iframe
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



  <h1>Tab-rendering fix (js)</h1>

<p>A js fix for certain UI elements, including maps, getting rendered into a
zero-sized frame by default. Here we resize it so it is visible once the tab is
clicked and no further interaction is required to see it.</p>


<div class="doc doc-object doc-module">



<a id="src.fix_tabrender"></a>
    <div class="doc doc-contents first">









  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h2 id="src.fix_tabrender.inject_iframe_js_code" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">inject_iframe_js_code</span><span class="p">(</span><span class="n">source</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Injects JavaScript code into a Streamlit app using an iframe.</p>
<p>This function creates a hidden div with a unique ID and injects the provided
JavaScript code into the parent document using an iframe. The iframe's source
is a JavaScript URL that creates a script element, sets its type to 'text/javascript',
and assigns the provided JavaScript code to its text content. The script element
is then appended to the hidden div in the parent document.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>source</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The JavaScript code to be injected.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>None</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/fix_tabrender.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">inject_iframe_js_code</span><span class="p">(</span><span class="n">source</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Injects JavaScript code into a Streamlit app using an iframe.</span>

<span class="sd">    This function creates a hidden div with a unique ID and injects the provided</span>
<span class="sd">    JavaScript code into the parent document using an iframe. The iframe&#39;s source</span>
<span class="sd">    is a JavaScript URL that creates a script element, sets its type to &#39;text/javascript&#39;,</span>
<span class="sd">    and assigns the provided JavaScript code to its text content. The script element</span>
<span class="sd">    is then appended to the hidden div in the parent document.</span>

<span class="sd">    Args:</span>
<span class="sd">        source (str): The JavaScript code to be injected.</span>

<span class="sd">    Returns:</span>
<span class="sd">        None</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">div_id</span> <span class="o">=</span> <span class="n">uuid</span><span class="o">.</span><span class="n">uuid4</span><span class="p">()</span>

    <span class="n">st</span><span class="o">.</span><span class="n">markdown</span><span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    &lt;div style=&quot;height: 0; width: 0; overflow: hidden;&quot; id=&quot;</span><span class="si">{</span><span class="n">div_id</span><span class="si">}</span><span class="s2">&quot;&gt;</span>
<span class="s2">        &lt;iframe src=&quot;javascript: </span><span class="se">\</span>
<span class="s2">            var script = document.createElement(&#39;script&#39;); </span><span class="se">\</span>
<span class="s2">            script.type = &#39;text/javascript&#39;; </span><span class="se">\</span>
<span class="s2">            script.text = </span><span class="si">{</span><span class="n">html</span><span class="o">.</span><span class="n">escape</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">source</span><span class="p">))</span><span class="si">}</span><span class="s2">; </span><span class="se">\</span>
<span class="s2">            var div = window.parent.document.getElementById(&#39;</span><span class="si">{</span><span class="n">div_id</span><span class="si">}</span><span class="s2">&#39;); </span><span class="se">\</span>
<span class="s2">            div.appendChild(script); </span><span class="se">\</span>
<span class="s2">            setTimeout(function() </span><span class="se">{{</span><span class="s2"> </span><span class="se">}}</span><span class="s2">, 0); </span><span class="se">\</span>
<span class="s2">        &quot;&gt;&lt;/iframe&gt;</span>
<span class="s2">    &lt;/div&gt;</span>
<span class="s2">    &quot;&quot;&quot;</span><span class="p">,</span>
        <span class="n">unsafe_allow_html</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="src.fix_tabrender.js_show_zeroheight_iframe" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">js_show_zeroheight_iframe</span><span class="p">(</span><span class="n">component_iframe_title</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Injects JavaScript code to dynamically set iframe height (located by title)</p>
<p>This function generates and injects JavaScript code that searches for
iframes with the given title and sets their height to the specified value.
The script attempts to find the iframes up to a maximum number of attempts,
and also listens for user interactions to reattempt setting the height.</p>
<p>See https://github.com/streamlit/streamlit/issues/7376 </p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>component_iframe_title</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The title attribute of the iframes to target.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>height</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The height to set for the iframes. Defaults to "auto".</p>
              </div>
            </td>
            <td>
                  <code>&#39;auto&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


<details class="notes" open>
  <summary>Notes</summary>
  <ul>
<li>The JavaScript code will attempt to find the iframes every 250
  milliseconds, up to a maximum of 20 attempts.</li>
<li>If the iframes are found, their height will be set to the specified value.</li>
<li>User interactions (e.g., click events) triggers a reattempt to set the height.</li>
</ul>
</details>

            <details class="quote">
              <summary>Source code in <code>src/fix_tabrender.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">js_show_zeroheight_iframe</span><span class="p">(</span><span class="n">component_iframe_title</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">height</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;auto&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Injects JavaScript code to dynamically set iframe height (located by title)</span>

<span class="sd">    This function generates and injects JavaScript code that searches for</span>
<span class="sd">    iframes with the given title and sets their height to the specified value.</span>
<span class="sd">    The script attempts to find the iframes up to a maximum number of attempts,</span>
<span class="sd">    and also listens for user interactions to reattempt setting the height.</span>

<span class="sd">    See https://github.com/streamlit/streamlit/issues/7376 </span>


<span class="sd">    Args:</span>
<span class="sd">        component_iframe_title (str): The title attribute of the iframes to target.</span>
<span class="sd">        height (str, optional): The height to set for the iframes. Defaults to &quot;auto&quot;.</span>

<span class="sd">    Notes:</span>
<span class="sd">        - The JavaScript code will attempt to find the iframes every 250</span>
<span class="sd">          milliseconds, up to a maximum of 20 attempts.</span>
<span class="sd">        - If the iframes are found, their height will be set to the specified value.</span>
<span class="sd">        - User interactions (e.g., click events) triggers a reattempt to set the height.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">source</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    (function() </span><span class="se">{{</span>
<span class="s2">    var attempts = 0;</span>
<span class="s2">    const maxAttempts = 20; // Max attempts to find the iframe</span>
<span class="s2">    const intervalMs = 250; // Interval between attempts in milliseconds</span>

<span class="s2">    function setIframeHeight() </span><span class="se">{{</span>
<span class="s2">        const intervalId = setInterval(function() </span><span class="se">{{</span>
<span class="s2">            var iframes = document.querySelectorAll(&#39;iframe[title=&quot;</span><span class="si">{</span><span class="n">component_iframe_title</span><span class="si">}</span><span class="s2">&quot;]&#39;);</span>
<span class="s2">            if (iframes.length &gt; 0 || attempts &gt; maxAttempts) </span><span class="se">{{</span>
<span class="s2">                if (iframes.length &gt; 0) </span><span class="se">{{</span>
<span class="s2">                    iframes.forEach(iframe =&gt; </span><span class="se">{{</span>
<span class="s2">                        if (iframe || iframe.height === &quot;0&quot; || iframe.style.height === &quot;0px&quot;) </span><span class="se">{{</span>
<span class="s2">                            iframe.style.height = &quot;</span><span class="si">{</span><span class="n">height</span><span class="si">}</span><span class="s2">&quot;;</span>
<span class="s2">                            iframe.setAttribute(&quot;height&quot;, &quot;</span><span class="si">{</span><span class="n">height</span><span class="si">}</span><span class="s2">&quot;);</span>
<span class="s2">                            console.log(&#39;Height of iframe with title &quot;</span><span class="si">{</span><span class="n">component_iframe_title</span><span class="si">}</span><span class="s2">&quot; set to </span><span class="si">{</span><span class="n">height</span><span class="si">}</span><span class="s2">.&#39;);</span>
<span class="s2">                        </span><span class="se">}}</span>
<span class="s2">                    </span><span class="se">}}</span><span class="s2">);</span>
<span class="s2">                </span><span class="se">}}</span><span class="s2"> else </span><span class="se">{{</span>
<span class="s2">                    console.log(&#39;Iframes with title &quot;</span><span class="si">{</span><span class="n">component_iframe_title</span><span class="si">}</span><span class="s2">&quot; not found after &#39; + maxAttempts + &#39; attempts.&#39;);</span>
<span class="s2">                </span><span class="se">}}</span>
<span class="s2">                clearInterval(intervalId); // Stop checking</span>
<span class="s2">            </span><span class="se">}}</span>
<span class="s2">            attempts++;</span>
<span class="s2">        </span><span class="se">}}</span><span class="s2">, intervalMs);</span>
<span class="s2">    </span><span class="se">}}</span>


<span class="s2">    function trackInteraction(event) </span><span class="se">{{</span>
<span class="s2">        console.log(&#39;User interaction detected:&#39;, event.type);</span>
<span class="s2">        setIframeHeight();</span>
<span class="s2">    </span><span class="se">}}</span>

<span class="s2">    setIframeHeight();</span>
<span class="s2">    document.addEventListener(&#39;click&#39;, trackInteraction);</span>
<span class="se">}}</span><span class="s2">)();</span>
<span class="s2">    &quot;&quot;&quot;</span>
    <span class="n">inject_iframe_js_code</span><span class="p">(</span><span class="n">source</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.f8cc74c7.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.c8b220af.min.js"></script>
      
    
  </body>
</html>